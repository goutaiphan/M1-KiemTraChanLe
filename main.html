<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ứng dụng kiểm tra chẵn lẻ</title>
    <link href="style.css" rel="stylesheet">
</head>

<body>
<div id="titleArea">Ứng dụng<br>kiểm tra chẵn lẻ</div>

<div id ='group'>
    <input id="inputArea"><br>
    <hr>
    <div id="resultArea"></div>
</div>

<button id="button">Kiểm tra</button>
</body>
</html>

<script>
    let inputArea = document.getElementById('inputArea');
    let resultArea = document.getElementById('resultArea');
    let button = document.getElementById('button');

    button.onclick = result;
    window.onkeydown = function (event) {
        event.preventDefault();
        switch (event.key) {
            case String(event.key.match(/[0-9+\-]/)):
                input();
                break;
            case 'Backspace':
                clear();
                break;
            case 'Delete':
            case 'Clear':
                allClear();
                break;
            case 'Enter':
                result();
                break;
        }
    }

    function input() {
        inputArea.value += this.event.key;
        resultArea.innerHTML = '';
    }

    function clear() {
        inputArea.value = inputArea.value.substr(0, inputArea.value.length - 1);
        resultArea.innerHTML = '';
    }

    function allClear() {
        inputArea.value = '';
        resultArea.innerHTML = '';
    }

    function result() {
        let formatValue = format(inputArea.value);
        if (formatValue === '') {
            inputArea.setCustomValidity('Biểu thức không hợp lệ.');
            inputArea.reportValidity();
        } else {
            try {
                inputArea.value = eval(formatValue);
                resultArea.innerHTML = eval(formatValue) % 2 === 0
                    ? 'Đây là số chẵn.'
                    : 'Đây là số lẻ.';
            } catch (e) {
                inputArea.setCustomValidity('Biểu thức không hợp lệ.');
                inputArea.reportValidity();
            }
        }
    }

    function format(inputValue) {
        let reMinus = inputValue.match(/(-)\1+/g);
        if (reMinus !== null) {
            for (let i = 0; i < reMinus.length; i++) {
                inputValue = reMinus[i].length % 2 === 0
                    ? inputValue.replace(reMinus[i], '+')
                    : inputValue.replace(reMinus[i], '-');
            }
        }

        inputValue = inputValue.replace(/(\+)\1+/g, '+');
        return inputValue;
    }
</script>